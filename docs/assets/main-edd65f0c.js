import{s as v,d as m}from"./drawTextLines-cd9263c8.js";const W=e=>e,p=400,u=700,w={width:50,color:"#ff0"},S={beforeSegment:(e,i,l)=>{const o=l===!0?w:{...w,...l},s=i.line.lineMetrix.lineAscent+i.line.lineMetrix.lineDescent,n=o.width/100*s,a=i.pos.y+s-n/2;e.save(),e.beginPath(),e.lineCap="round",e.strokeStyle=o.color,e.lineWidth=n,e.moveTo(i.pos.x+n/2,a),e.lineTo(i.pos.x-n/2+i.text.reduce((r,d)=>r+d.metrix.width,0),a),e.stroke(),e.restore()}},y={width:1},k={beforeSegment:(e,i,l)=>{const o=l===!0?y:{...y,...l},s=i.pos.y+i.line.lineMetrix.lineAscent+1;e.save(),e.beginPath(),e.strokeStyle=i.style.fontColor,e.lineWidth=o.width,e.moveTo(i.pos.x,s),e.lineTo(i.pos.x+i.text.reduce((n,a)=>n+a.metrix.width,0),s),e.stroke(),e.restore()}},f=W({text:`Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt _~^,|...

花子は、古びたアトリエで縦書きCanvasに思いを馳せていた。彼女の心は、過去の情熱的な絵画と未来の可能性とで彩られていた。CanvasRenderingContext2Dを通じて、彼女の筆が魔法のように踊り、色と形が交じり合う。「その魔法のキャンバスには、季節が舞い、想像が咲く」。花子の作品は、縦書きならではの風情が溢れ、心の底からの芸術の詩となるのだった。
-fin-`,setting:{lineHeight:1.5,align:"left",direction:"horizontal"},extensions:{underline:k,marker:S},initialStyle:{fontFamily:"sans-serif",fontSize:20,fontColor:"#333",fontWeight:p,fontStyle:"normal"},styles:[{at:5,style:{fontFamily:'"Times"',fontWeight:u,fontSize:36,fontColor:"#39a"}},{at:12,style:{fontFamily:'"Hiragino Maru Gothic Pro"',fontSize:18,fontColor:"#777"}},{at:22,style:{fontWeight:u,fontSize:32,fontColor:"#ea3"}},{at:27,style:{fontWeight:p,fontColor:"#777"}},{at:58,style:{fontColor:"#f63",fontSize:40,marker:{color:"#feee88",width:35},underline:{width:2}}},{at:61,style:{fontColor:"#777",fontSize:20,underline:!1,marker:!1}},{at:101,style:{fontFamily:"'Zen Kurenaido'",fontColor:"#777",fontSize:18}},{at:104,style:{marker:!1}},{at:113,style:{fontFamily:"BIZ UDPGothic",marker:{color:"gold"}}},{at:122,style:{fontFamily:"'Zen Kurenaido'",marker:!1}},{at:163,style:{underline:!0}},{at:188,style:{underline:!1}}]});const c=e=>document.querySelector(e),x=c("#app"),t={wrapWidth:500,debug:!1,isVertical:f.setting.direction==="vertical",lineHeight:f.setting.lineHeight??1.5,align:f.setting.align??"left",onUpdate:e=>{}},T=()=>{const e=c("#wrapWidth");e.value=t.wrapWidth.toString();const i=c("#wrapWidthValue");e.addEventListener("input",()=>{i.innerText=e.value+"px",t.wrapWidth=e.valueAsNumber,t.onUpdate()});const l=c("#debug");l.checked=t.debug,l.addEventListener("change",r=>{t.debug=r.target.checked,t.onUpdate()});const o=c("#vertical");o.checked=t.isVertical,o.addEventListener("change",r=>{t.isVertical=r.target.checked,t.onUpdate()});const s=c("#lineHeight");s.value=t.lineHeight.toString();const n=c("#lineHeightValue");s.addEventListener("input",()=>{n.innerText=s.value,t.lineHeight=s.valueAsNumber,t.onUpdate()});const a=c("#textAlign");a.value=t.align,a.addEventListener("change",r=>{const d=r.target.value,h=["left","center","right"].find(g=>g===d);h&&(t.align=h,t.onUpdate())})},b=()=>{const e=document.createElement("canvas"),i=e.getContext("2d");e.style.border="1px solid black",x.appendChild(e);const l={wrapWidth:t.wrapWidth,isVertical:t.isVertical};let o;const s=()=>{v(t.debug);const n={...f};n.setting.align=t.align,n.setting.lineHeight=t.lineHeight,n.setting.direction=t.isVertical?"vertical":"horizontal";const a=n.setting.direction==="vertical";e.style.writingMode=a?"vertical-rl":"horizontal-tb";const r=e.width/2,d=e.height/2,h=a?r:0,g=a?d:r;console.time("drawText"),o=m(i,n,h,0,g,o),console.timeEnd("drawText")};t.onUpdate=n=>{n&&(o=void 0);const a=t.isVertical,r=800,d=a?r:t.wrapWidth,h=a?t.wrapWidth:r;e.width=d*2,e.height=h*2,e.style.width=`${d}px`,e.style.height=`${h}px`,i.resetTransform(),i.scale(2,2),l.isVertical!==t.isVertical&&(o=void 0),l.wrapWidth!==t.wrapWidth&&o&&(o.lineBreaks=void 0),l.wrapWidth=t.wrapWidth,l.isVertical=t.isVertical,s()},T(),t.onUpdate()},C=async()=>{await document.fonts.ready,window.requestAnimationFrame(()=>t.onUpdate(!0))};b();C();
